Application architecture:

* stateful nodejs server, handles one active session at a time
* server is configured with the content/rules, content/module, and campaign subdirectories for the current session
* the content/rules subdirectory contains one or more PDF files which describe the game rules that apply to the session
* the content/module subdirectory contains one or more PDF files which describe the setting and npcs used for the 
  current session
* the campaign subdirectory contains the current campaign state in various files these include character sheets for all
  players and major NPCs. It also includes a journal that records the history and current state of the campaign.
* the server implements multiple independent LLM agents, each specialized for a their task:
    * master agent - this is the primary agent that drives interactions with other agents. The game master is provided
      the PDF(s) from the content/module directory and data from the campaign subdirectory as context. This agent
      interacts with players though a shared chat channel exposed via a web UI. The master agent summarizes events
      for the campaign journal.
    * rule agent - The master agent may direct queries on how the rules apply to specific situations to the rule
      lawyer agent. The rule agent is provided the PDF(s) from the content/rules subdirectory as context. The questions
      and responses of the rule agent are available for players to review in the "rules" chat channel exposed via the 
      web UI. Players may ask directly ask the rules agent questions in this channel. Recent answers in the rules channel are included in the master agent's context.
    * character agent - These agents play the role of player characters for which no human player is available. An
      independent agent is created for each character. These agents participate in the master chat channel as a 
      player would (they observer the actions described by other player and the game master and generate an appropriate
      response). Character agents can also be created for prominent recurring NPCs int he campaign, but minor NPCs can
      be role played by the master agent. Character agents are provided with their character sheet as context. This 
      document includes the character's stats, as well as background information. The character agent also generates
      a journal containing the character's current state, immediate goals, etc. Old journal entries are summarized and become part of the character's background. Recent journal entries are provided to the agent as context.
* The web UI allows the character being played by the user to be selected, created, and/or edited. 
* Creating a character involves establishing the stats for the character, an initial background, and the character's 
  physical description. This process is driven by the rule agent with guidance from the master agent. The master 
  agent determines the allowed character level(s) and may put other constraints on characters as appropriate for the campaign. The master agent can present pre-created characters found in the module PDF(s) as options when the player
  wants to create a character. The actual character creation process is driven by the rules agent. Given the constraints
  provided by the master agent and a character description, the rules agent steps the player through the character creation process. The result is a character sheet file that is saved in the campaign subdirectory.
* The main part of the web UI is the chat interface. This interface allows players to view text and image output generated by the agents running in the service. It also allows players to enter text and upload images as input 
to the agents.
* The main chat interface allows the player to select which other players and agents can see a given input message. Players can use this chat interface as a private channel to communicate between themselves, possibly including 
agent characters, but excluding the master and rule agents, for example.
* The web UI will also provide a panel to the side of the chat UI where maps and other persistent images can be shown. Images sent by agents to the chat channel can direct the image to be displayed in this area. Only a single image is
visible at a time, but scrollable thumbnails allow the user to select previously displayed images.
* The image display area will also support the positioning and movement of overlay tokens, representing player characters, npcs, etc. An image (with transparency) is provided for each token. The tokens will be scaled to match the scale of the map. The master and character agents can direct the addition or removal of a token, or direct a token to be moved to a new location. The user can drag and drop a token, which causes the location of the token to be updated for other users. The current token locations along with the background image are captured as a single image and included in master agent context.